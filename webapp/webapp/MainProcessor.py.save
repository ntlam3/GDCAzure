import cre
import requests
import datetime
import os
import URL
#from azure.storage.blob import BlobServiceClient, BlobClient, ContainerClient
#blob_service_client=BlobServiceClient.from_connection_string("DefaultEndpointsProtocol=https;AccountName=lamnguyen;AccountKey=hDHmxcT1ICcyRQ2SpGBF+qfl4htsN8Z6TJRXYiTcAy9i4uBxFiulQgPzn+j0EFyyiWSnr5SWSo8Z+ASt3BRT3w==;EndpointSuffix=core.windows.net")
def login():
    payload = {
    'name': cre.name,
    'password': cre.password,
    "autologin": 1,
    "enter": "Signin"
    }
    login_url= 'http://azure.thezabbix.com/zabbix/index.php'
    s=requests.session()
    r=s.post(login_url, data = payload)
    print(payload['name'])
    print(r.text)
    return s
#------------------EU-Promotion----------------------
def eupromo(s):
    print('------------------EU-Promotion----------------------')
    s14_qlik_cpu=s.get(URL.s14_qlik_cpu_url)
    s14_qlik_mem=s.get(URL.s14_qlik_mem_url)
    s15_ap01_cpu=s.get(URL.s15_ap01_cpu_url)
    s15_ap01_mem=s.get(URL.s15_ap01_mem_url)
    s15_ap02_cpu=s.get(URL.s15_ap02_cpu_url)
    s15_ap02_mem=s.get(URL.s15_ap02_mem_url)
    s16_ap03_cpu=s.get(URL.s16_ap03_cpu_url)
    s16_ap03_mem=s.get(URL.s16_ap03_cpu_url)
    s16_ap04_cpu=s.get(URL.s16_ap04_cpu_url)
    s16_ap04_mem=s.get(URL.s16_ap04_mem_url)
    s17_ap05_cpu=s.get(URL.s17_ap05_cpu_url)
    s17_ap05_mem=s.get(URL.s17_ap05_mem_url)
    s18_bi01_cpu=s.get(URL.s18_bi01_cpu_url)
    s18_bi01_mem=s.get(URL.s18_bi01_mem_url)
    s18_build01_cpu=s.get(URL.s18_build01_cpu_url)
    s18_build01_mem=s.get(URL.s18_build01_mem_url)
    s19_dia01_cpu=s.get(URL.s19_dia01_cpu_url)
    s19_dia01_mem=s.get(URL.s19_dia01_mem_url)
    s19_acr01_cpu=s.get(URL.s19_acr01_cpu_url)
    s19_acr01_mem=s.get(URL.s19_acr01_mem_url)
    date_time=datetime.datetime.now()
    eupromo_src="Zabbix_images-EUpromo" + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    folder_eupromo="//var//www//webapp//webapp//static//"+eupromo_src
    
    if (os.path.isdir(folder_eupromo)):
        pass
    else:
	os.umask(0)
        os.mkdir(folder_eupromo,0o777)
    file_s14_qlik_cpu='s14_qlik_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s14_qlik_mem='s14_qlik_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s15_ap01_cpu='s15_ap01_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s15_ap01_mem='s15_ap01_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s15_ap02_cpu='s15_ap02_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s15_ap02_mem='s15_ap02_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s16_ap03_cpu='s16_ap03_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s16_ap03_mem='s16_ap03_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s16_ap04_cpu='s16_ap04_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s16_ap04_mem='s16_ap04_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s17_ap05_cpu='s17_ap05_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s17_ap05_mem='s17_ap05_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s18_bi01_cpu='s18_bi01_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s18_bi01_mem='s18_bi01_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s18_build01_cpu='s18_build01_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s18_build01_mem='s18_build01_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s19_dia01_cpu='s19_dia01_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s19_dia01_mem='s19_dia01_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s19_acr01_cpu='s19_acr01_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s19_acr01_mem='s19_acr01_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')

    f=open(folder_eupromo + '//s14_qlik_cpu.jpg','wb')
    f.write(s14_qlik_cpu.content)
    #container_client=(blob_service_client.list_containers)[0]
    f.close()
    f=open(folder_eupromo + '//s14_qlik_mem.jpg','wb')
    f.write(s14_qlik_mem.content)
    f.close()
    f=open(folder_eupromo + '//s15_ap01_cpu.jpg','wb')
    f.write(s15_ap01_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s15_ap01_mem.jpg','wb')
    f.write(s15_ap01_mem.content)
    f.close()
    f=open(folder_eupromo + '//s16_ap03_cpu.jpg','wb')
    f.write(s16_ap03_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s16_ap03_mem.jpg','wb')
    f.write(s16_ap03_mem.content)
    f.close()
    f=open(folder_eupromo + '//s16_ap04_cpu.jpg','wb')
    f.write(s16_ap04_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s16_ap04_mem.jpg','wb')
    f.write(s16_ap04_mem.content)
    f.close()
    f=open(folder_eupromo + '//s17_ap05_cpu.jpg','wb')
    f.write(s17_ap05_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s17_ap05_mem.jpg','wb')
    f.write(s17_ap05_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s18_bi01_cpu.jpg','wb')
    f.write(s18_bi01_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s18_bi01_mem.jpg','wb')
    f.write(s18_bi01_mem.content)
    f.close()
    f=open(folder_eupromo + '//s18_build01_cpu.jpg','wb')
    f.write(s18_build01_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s18_build01_mem.jpg','wb')
    f.write(s18_build01_mem.content)
    f.close()
    f=open(folder_eupromo + '//s19_dia01_cpu.jpg','wb')
    f.write(s19_dia01_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s19_dia01_mem.jpg','wb')
    f.write(s19_dia01_mem.content)
    f.close()
    f=open(folder_eupromo + '//s19_acr01_cpu.jpg','wb')
    f.write(s19_acr01_cpu.content)
    f.close()
    f=open(folder_eupromo + '//s19_acr01_mem.jpg','wb')
    f.write(s19_acr01_mem.content)
    f.close()
    return eupromo_src
#------------------KCDM----------------------
def KCDM(s):
    print('------------------KCDM----------------------')
    date_time=datetime.datetime.now()
    kcdm_src="Zabbix_images-KCDM" + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    folder_KCDM="//var//www//webapp//webapp//static//"+kcdm_src
    if (os.path.isdir(folder_KCDM)):
        pass
    else:
	os.umask(0)
        os.mkdir(folder_KCDM,0o777)
    s12_ap_cpu=s.get(URL.s12_ap_cpu_url)
    s12_ap_mem=s.get(URL.s12_ap_mem_url)
    s13_db_cpu=s.get(URL.s13_db_cpu_url)
    s13_db_page=s.get(URL.s13_db_page_url)
    s14_ap_cpu=s.get(URL.s14_ap_cpu_url)
    s14_ap_mem=s.get(URL.s14_ap_mem_url)
    file_s12_ap_cpu='s12_app_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s12_ap_cpu='s12_app_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s13_db_cpu='s13_db_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s13_db_page='s13_db_page' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s14_ap_cpu='s14_ap_cpu' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    file_s14_ap_mem='s14_ap_mem' + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    f=open(folder_KCDM + '//s12_ap_cpu.jpg','wb')
    f.write(s12_ap_cpu.content)
    f.close()
    f=open(folder_KCDM + '//s12_ap_mem.jpg','wb')
    f.write(s12_ap_mem.content)
    f.close()
    f=open(folder_KCDM + '//s13_db_cpu.jpg','wb')
    f.write(s13_db_cpu.content)
    f.close()
    f=open(folder_KCDM + '//s13_db_page.jpg','wb')
    f.write(s13_db_page.content)
    f.close()
    f=open(folder_KCDM + '//s14_ap_cpu.jpg','wb')
    f.write(s14_ap_cpu.content)
    f.close()
    f=open(folder_KCDM + '//s14_ap_mem.jpg','wb')
    f.write(s14_ap_mem.content)
    f.close()
    return kcdm_src

def kcdm_dynamic(s):
    print('------------------KCDM Dynamic----------------------')
    date_time=datetime.datetime.now()
    kcdm_dynamic_src="static\\Zabbix_images-KCDM-Dynamic" + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    folder_KCDM_dynamic="C:\\Python_projects\\webapp\\"+kcdm_dynamic_src
    if (os.path.isdir(folder_KCDM_dynamic)):
        pass
    else:       Target WSGI script '/var/www/webapp/webapp.wsgi' cannot be loaded as Python module
    cm_db_cpu_url=URL.get_cm_db_cpu()
    cm_db_page_url=URL.get_cm_db_page()
    cm_data_disk_url=URL.get_cm_data_disk()
    cm_db_log_url=URL.get_cm_db_log()
    length=len(cm_db_cpu_url)    
    for element in range (0,length-1):
        cm_db_cpu=s.get(cm_db_cpu_url[element])
        f=open(folder_KCDM_dynamic + '\\cm_db_cpu_'+str(element)+'.jpg','wb')
        f.write(cm_db_cpu.content)
        f.close()
        cm_db_page=s.get(cm_db_page_url[element])
        f=open(folder_KCDM_dynamic + '\\cm_db_page_'+str(element)+'.jpg','wb')
        f.write(cm_db_page.content)
        f.close()
        cm_data_disk=s.get(cm_data_disk_url[element])
        f=open(folder_KCDM_dynamic + '\\cm_data_disk_'+str(element)+'.jpg','wb')
        f.write(cm_data_disk.content)
        f.close()
        cm_db_log=s.get(cm_db_log_url[element])
        f=open(folder_KCDM_dynamic + '\\cm_db_log_'+str(element)+'.jpg','wb')
        f.write(cm_db_log.content)
        f.close()
    return kcdm_dynamic_src
    
#------------------CRM----------------------
def crm(s):
    print('------------------CRM----------------------')
    date_time=datetime.datetime.now()
    crm_src="Zabbix_images-CRM" + '-' + date_time.strftime('%y') + '-' + date_time.strftime('%m') + '-' + date_time.strftime('%d')
    folder_crm="//var//www//webapp//webapp//static//"+crm_src
    if (os.path.isdir(folder_crm)):
        pass
    else:
	os.umask(0)
        os.mkdir(folder_crm,0o777)
    s19_app_cpu=s.get(URL.s19_app_cpu_url)
    s19_app_mem=s.get(URL.s19_app_mem_url)
    s20_db_cpu=s.get(URL.s20_db_cpu_url)
    s20_db_mem=s.get(URL.s20_db_mem_url)
    s21_app_cpu=s.get(URL.s21_app_cpu_url)
    s21_app_mem=s.get(URL.s21_app_mem_url)
    s21_db_cpu=s.get(URL.s21_db_cpu_url)
    s21_db_mem=s.get(URL.s21_db_mem_url)
    s22_app_cpu=s.get(URL.s22_app_cpu_url)
    s22_app_mem=s.get(URL.s22_app_mem_url)
    s23_db_cpu=s.get(URL.s23_db_cpu_url)
    s23_db_mem=s.get(URL.s23_db_mem_url)
    s23_page_life=s.get(URL.s23_page_life_url)
    s23_db_log=s.get(URL.s23_db_log_url)
    s24_app_cpu=s.get(URL.s24_app_cpu_url)
    s24_app_mem=s.get(URL.s24_app_mem_url)
    s24_db_cpu=s.get(URL.s24_db_cpu_url)
    s24_db_mem=s.get(URL.s24_db_mem_url)
    s25_app_cpu=s.get(URL.s25_app_cpu_url)
    s25_app_mem=s.get(URL.s25_app_mem_url)
    s26_db_cpu=s.get(URL.s26_db_cpu_url)
    s26_db_mem=s.get(URL.s26_db_mem_url)
    s27_app_cpu=s.get(URL.s27_app_cpu_url)
    s27_app_mem=s.get(URL.s27_app_mem_url)
    s27_db_cpu=s.get(URL.s27_db_cpu_url)
    s27_db_mem=s.get(URL.s27_db_mem_url)
    f=open(folder_crm + '//s19_app_cpu.jpg','wb')
    f.write(s19_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s19_app_mem.jpg','wb')
    f.write(s19_app_mem.content)
    f.close()
    f=open(folder_crm + '//s20_db_cpu.jpg','wb')
    f.write(s20_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s20_db_mem.jpg','wb')
    f.write(s20_db_mem.content)
    f.close()
    f=open(folder_crm + '//s21_app_cpu.jpg','wb')
    f.write(s21_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s21_app_mem.jpg','wb')
    f.write(s21_app_mem.content)
    f.close()
    f=open(folder_crm + '//s21_db_cpu.jpg','wb')
    f.write(s21_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s21_db_mem.jpg','wb')
    f.write(s21_db_mem.content)
    f.close()
    f=open(folder_crm + '//s22_app_cpu.jpg','wb')
    f.write(s22_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s22_app_mem.jpg','wb')
    f.write(s22_app_mem.content)
    f.close()
    f=open(folder_crm + '//s23_db_cpu.jpg','wb')
    f.write(s23_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s23_db_mem.jpg','wb')
    f.write(s23_db_mem.content)
    f.close()
    f=open(folder_crm + '//s23_page_life.jpg','wb')
    f.write(s23_page_life.content)
    f.close()
    f=open(folder_crm + '//s23_db_log.jpg','wb')
    f.write(s23_db_log.content)
    f.close()
    f=open(folder_crm + '//s24_app_cpu.jpg','wb')
    f.write(s24_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s24_app_mem.jpg','wb')
    f.write(s24_app_mem.content)
    f.close()
    f=open(folder_crm + '//s24_db_cpu.jpg','wb')
    f.write(s24_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s24_db_mem.jpg','wb')
    f.write(s24_db_mem.content)
    f.close()
    f=open(folder_crm + '//s25_app_cpu.jpg','wb')
    f.write(s25_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s25_app_mem.jpg','wb')
    f.write(s25_app_mem.content)
    f.close()
    f=open(folder_crm + '//s26_db_cpu.jpg','wb')
    f.write(s26_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s26_db_mem.jpg','wb')
    f.write(s26_db_mem.content)
    f.close()
    f=open(folder_crm + '//s27_app_cpu.jpg','wb')
    f.write(s27_app_cpu.content)
    f.close()
    f=open(folder_crm + '//s27_app_mem.jpg','wb')
    f.write(s27_app_mem.content)
    f.close()
    f=open(folder_crm + '//s27_db_cpu.jpg','wb')
    f.write(s27_db_cpu.content)
    f.close()
    f=open(folder_crm + '//s27_db_mem.jpg','wb')
    f.write(s27_db_mem.content)
    f.close()

    #folder_array=[eupromo_src,kcdm_src,crm_src]
    return crm_src
    #return folder_crm
